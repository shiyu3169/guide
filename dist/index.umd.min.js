!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["exports","react","react-dom"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).byteGuide={},e.React,e.ReactDOM)}(this,(function(e,t,o){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=n(t),i=n(o);function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function a(e){for(var t=1;arguments.length>t;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){c(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,r,i,l,a=[],u=!0,c=!1;try{if(i=(o=o.call(e)).next,0===t){if(Object(o)!==o)return;u=!1}else for(;!(u=(n=i.call(o)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(e){c=!0,r=e}finally{try{if(!u&&null!=o.return&&(l=o.return(),Object(l)!==l))return}finally{if(c)throw r}}return a}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return d(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=Array(t);t>o;o++)n[o]=e[o];return n}var s="j-byted-guide__custom-anchor",p=function(e){if(""+e!="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e},h=function(e){return(x(e)?e.ownerDocument:e.document)||window.document},m=function(e){return h(e).documentElement},g=function(e){return p(e).getComputedStyle(e)},b=function(e){return e?(e.nodeName||"").toLowerCase():""},v=function(e){return e&&"html"!==b(e)?e.assignedSlot||e.parentNode||e.host||m(e):e},x=function(e){return e instanceof p(e).Element||e instanceof Element},y=function(e){return e instanceof p(e).HTMLElement||e instanceof HTMLElement},w=function(e){return["table","td","th"].indexOf(b(e))>=0},E=function(e){return y(e)&&"fixed"!==g(e).position?e.offsetParent:null},S=function(e,t){var o=p(e);null==t||t(e);for(var n=E(e);n&&w(n)&&"static"===g(n).position;)null==t||t(n),n=E(n);return n||function(e,t){null==t||t(e);for(var o=v(e);y(o)&&0>["html","body"].indexOf(b(o));){null==t||t(o);var n=g(o);if("none"!==n.transform||"none"!==n.perspective||n.willChange&&"auto"!==n.willChange)return o;o=v(o)}return o}(e,t)||o},k=12,T=function(e,t,o,n){var r,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bottom",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{x:0,y:0},a=e.getBoundingClientRect(),u=t.getBoundingClientRect(),c=o.getBoundingClientRect(),f=n.scrollTop,d="body"===b(o),s="fixed"===g(t).position,p=(r=0,S(t,(function(e){r+=e.offsetTop})),r),h=s?u.top:d?u.top+f:p,m=u.height+h,v=u.left-c.left,x=u.width,y=u.height,w={top:{top:h-a.height-k,left:v+x/2-a.width/2},bottom:{top:m+k,left:v+x/2-a.width/2},left:{top:h+y/2-a.height/2,left:v-a.width-k},right:{top:h+y/2-a.height/2,left:v+x+k},"top-right":{top:h-a.height-k,left:v+x-a.width},"top-left":{top:h-a.height-k,left:v},"bottom-right":{top:m+k,left:v+x-a.width},"bottom-left":{top:m+k,left:v},"right-top":{top:h,left:v+x+k},"left-top":{top:h,left:v-a.width-k},"right-bottom":{top:m-a.height,left:v+x+k},"left-bottom":{top:m-a.height,left:v-a.width-k}}[i];return{position:s?"fixed":"absolute",top:w.top+(l.y||0),left:w.left+(l.x||0)}},C=function(e){return{bottom:"top",top:"bottom",left:"right",right:"left"}[e]},j={NEXT_STEP:{zh:"下一步",en:"Next step",ja:"次のステップ"},I_KNOW:{zh:"我知道了",en:"I know",ja:"知ってる"},STEP_NUMBER:{zh:function(e,t){return"第".concat(e,"步， 共").concat(t,"步")},en:function(e,t){return"Step ".concat(e," of ").concat(t)},ja:function(e,t){return"Step ".concat(e," of ").concat(t)}},PREV_STEP:{zh:"上一步",en:"Previous step",ja:"前へ"},SKIP_STEP:{zh:"跳过",en:"Skip",ja:"スキップ"}};function N(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===o&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}N('.guide-mask{position:absolute;left:0;top:0;border-color:rgba(0,0,0,.6);border-style:solid;z-index:1001;box-sizing:border-box}.guide-mask:after{content:"";display:block;position:absolute;top:-1px;left:-1px;width:100%;height:100%;border-radius:4px;border:1px solid #fff;box-shadow:0 0 0 1px #fff;background:transparent}');var O=function(e){var o=e.className,n=e.anchorEl,l=e.realWindow,a=f(t.useState({}),2),u=a[0],c=a[1],d=t.useRef(0),s=function(){var e=function(e){var t=m(e);t.style.overflow="hidden";var o=t.scrollWidth,n=t.scrollHeight,r=t.scrollTop,i=e.getBoundingClientRect(),l=i.height,a=i.width,u=i.left,c=i.top+r;return{width:o,height:n,borderTopWidth:Math.max(c,0),borderBottomWidth:Math.max(n-l-c,0),borderRightWidth:Math.max(o-a-u,0),borderLeftWidth:Math.max(u,0)}}(n);c(e)},p=function(){d.current&&l.cancelAnimationFrame(d.current),d.current=l.requestAnimationFrame((function(){s()}))};return t.useEffect((function(){s()}),[n]),t.useEffect((function(){return l.addEventListener("resize",p),function(){l.removeEventListener("resize",p)}}),[l,n]),n?i.default.createPortal(r.default.createElement("div",{className:"guide-mask ".concat(o),style:u}),h(n).body):null},P=function(e){var t=e.size,o=void 0===t?"16":t,n=e.fill,i=void 0===n?"#666":n,l=e.onClick,a=e.className;return r.default.createElement("div",{onClick:void 0===l?function(){}:l,className:void 0===a?"":a},r.default.createElement("svg",{width:o,height:o,viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},r.default.createElement("g",null,r.default.createElement("g",null,r.default.createElement("rect",{fillOpacity:"0.01",fill:"#FFFFFF",x:"0",y:"0",width:"48",height:"48",strokeWidth:"4",stroke:"none",fillRule:"evenodd"}),r.default.createElement("path",{d:"M14,14 L34,34",stroke:i,strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",fillRule:"evenodd"}),r.default.createElement("path",{d:"M14,34 L34,14",stroke:i,strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",fillRule:"evenodd"})))))};N(".guide-modal{position:absolute;width:340px;z-index:1100;background:#fff;box-shadow:0 0 4px 0 #999;border-radius:4px;padding:16px;box-shadow:0 2px 6px 0 #999}.guide-modal *{font-family:PingFangSC-Regular,PingFang SC;text-align:left}.guide-modal-title{display:block;font-size:14px;font-weight:600;height:22px;line-height:22px;margin-bottom:8px}.guide-modal-content{color:#666;font-size:12px;font-weight:400;line-height:20px;margin-bottom:16px}.guide-modal-close-icon{position:absolute;top:16px;right:16px;cursor:pointer}.guide-modal-arrow{position:absolute;width:10px;height:10px;background:#fff;transform:rotate(45deg)}.guide-modal-hotspot{position:absolute;width:16px;height:16px;-webkit-border-radius:50%;border-radius:50%;background-color:#4e83fd;animation:pulse 1s infinite}.guide-modal-footer{width:100%;max-height:26px;display:flex;align-items:center;justify-content:space-between}.guide-modal-footer *{font-size:12px;font-weight:400}.guide-modal-footer-text{color:#999}.guide-modal-footer-btn-group{display:flex;justify-self:flex-end}.guide-modal-footer-btn{padding:3px 16px;line-height:20px;border-radius:4px;color:#fff;background:#2f88ff;box-shadow:0 2px 6px 0 rgba(0,0,0,.08);border:none;outline:none;cursor:pointer;word-break:keep-all}.guide-modal-footer-btn:hover{background-color:#40a9ff}.guide-modal-footer-btn:focus{outline:none;box-shadow:0 0 4px #338aff;transition:.3s}.guide-modal-footer-prev-btn,.guide-modal-footer-skip-btn{margin-right:10px}.guide-modal-title:focus{background:#ff0;box-shadow:0 0 4px #338aff;border:1px dotted #ccc}@keyframes pulse{0%{box-shadow:0 0 0 0 #4e83fd}to{box-shadow:0 0 0 8px transparent}}");var M="guide-modal",R=function(e){var o=e.anchorEl,n=e.parentEl,l=e.realWindow,u=e.steps,d=e.stepIndex,s=e.mask,p=e.arrow,h=e.hotspot,x=e.closable,w=e.onClose,E=e.onChange,S=e.stepText,j=e.nextText,N=e.okText,O=e.className,R=e.TEXT,L=e.prevText,B=e.showPreviousBtn,z=e.showSkipBtn,_=e.skipText,W=e.closeEle,A=e.autoScroll,F=u[d],D=!Object.prototype.hasOwnProperty.call(F,"visible")||F.visible,I=t.useRef(null),q=t.useRef(0),H=t.useRef(null),K=t.useRef(0),U=f(t.useState({}),2),X=U[0],V=U[1],G=f(t.useState({}),2),Y=G[0],$=G[1],J=f(t.useState({}),2),Q=J[0],Z=J[1],ee=t.useMemo((function(){return function(e,t){for(var o=v(e);y(o)&&0>["html","body"].indexOf(b(o));){var n=g(o).overflowY,r="visible"!==n&&"hidden"!==n;if(null==t||t(o),r&&o.scrollHeight>o.clientHeight)return o;o=o.parentNode}return m(e)}(o)}),[o]),te=d!==u.length-1?j||R("NEXT_STEP"):N||R("I_KNOW"),oe=L||R("PREV_STEP"),ne=_||R("SKIP_STEP"),re=S||R("STEP_NUMBER"),ie=function(){var e=F.placement,t=I.current;if(t){var r=T(t,o,n,ee,e,F.offset),i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bottom",o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,r=e.getBoundingClientRect(),i=f(t.split("-"),2),l=i[0],u=i[1],d=c({boxShadow:o?"none":{top:"1px 1px 1px 0px #ccc",right:"-1px 1px 1px 0px #ccc",bottom:"-1px -1px 1px 0px #ccc",left:"1px -1px 1px 0px #ccc"}[l]},C(l),-5);if(u)return a(c({},u,2*n),d);var s={};return["bottom","top"].includes(l)&&(s.right=(r.width-10)/2),["left","right"].includes(l)&&(s.top=(r.height-10)/2),a(a({},s),d)}(t,e,s),l=function(){var e,t,o=arguments.length>1?arguments[1]:void 0,n=f((arguments.length>0&&void 0!==arguments[0]?arguments[0]:"bottom").split("-"),2),r=n[0],i=n[1],l=C(r);return["top","bottom"].includes(r)?i&&"right"!==i?(c(e={},l,o[l]-24),c(e,"left",o.left-3),e):(c(t={},l,o[l]-24),c(t,"right",o.right-3),t):["right","left"].includes(r)?c(i&&"top"!==i?{bottom:o.bottom-3}:{top:o.top-3},l,o[l]-24):o}(e,i);V(r),$(i),Z(l)}},le=function(){q.current&&l.cancelAnimationFrame(q.current),q.current=l.requestAnimationFrame((function(){ie()}))},ae=function(e){var t,o,n,r=(null===(t=I.current)||void 0===t?void 0:t.querySelectorAll(".guide-modal-title, .guide-modal-content, .guide-modal-footer-text, .guide-modal-footer-btn"))||null;if(9===e.keyCode&&r){null==e||null===(o=e.preventDefault)||void 0===o||o.call(e);var i=K.current,l=r.length,a=r[i];null===(n=H.current)||void 0===n||n.blur(),a.focus(),H.current=a,i!==l-1||e.shiftKey?0===i&&e.shiftKey?K.current=l-1:e.shiftKey?K.current--:K.current++:K.current=0}};return t.useEffect((function(){if(F.skip)E(1);else if(D)return K.current=0,A&&function(){var e=I.current,t=o.getBoundingClientRect(),n=e.getBoundingClientRect(),r=ee.getBoundingClientRect(),i="html"===b(ee),l=ee.clientHeight,a=i?0:r.top;if(l>t.top-a+t.height+n.height+k&&t.top>n.height+k||ee.scrollTo({left:0,top:ee.scrollTop+t.top-a+t.height/2-l/2+k,behavior:"smooth"}),"html"!==b(ee)){var u=m(o);r.top+r.height<window.innerHeight&&r.height>=r.bottom||u.scrollTo({left:0,top:u.scrollTop+r.top+r.height/2-window.innerHeight/2+k,behavior:"smooth"})}}(),ae({keyCode:9}),ie(),l.addEventListener("resize",le),l.addEventListener("keydown",ae),function(){l.removeEventListener("resize",le),l.removeEventListener("keydown",ae)}}),[D,F,o]),D?i.default.createPortal(r.default.createElement("div",{ref:I,className:"".concat(M," ").concat(O),style:X},p&&r.default.createElement("span",{className:"".concat(M,"-arrow"),style:Y}),h&&r.default.createElement("div",{className:"".concat(M,"-hotspot"),style:Q}),W?r.default.createElement("div",{className:"".concat(M,"-close-icon"),onClick:w},W):x?r.default.createElement(P,{className:"".concat(M,"-close-icon"),onClick:w}):null,r.default.createElement("div",{className:"".concat(M,"-title")},F.title),r.default.createElement("div",{className:"".concat(M,"-content")},"function"==typeof F.content?F.content():F.content),r.default.createElement("div",{className:"".concat(M,"-footer")},r.default.createElement("span",{className:"".concat(M,"-footer-text")},re(d+1,u.length)),r.default.createElement("div",{className:"".concat(M,"-footer-btn-group")},z&&d!=u.length-1&&r.default.createElement("button",{className:"".concat(M,"-footer-btn ").concat(M,"-footer-skip-btn"),onClick:w},ne+""),B&&0!==d&&r.default.createElement("button",{className:"".concat(M,"-footer-btn ").concat(M,"-footer-prev-btn"),onClick:function(){var e;null===(e=F.beforeStepChange)||void 0===e||e.call(F,F,d,u),E(-1)}},oe+""),r.default.createElement("button",{className:"".concat(M,"-footer-btn ").concat(M,"-footer-next-btn"),onClick:function(){var e;null===(e=F.beforeStepChange)||void 0===e||e.call(F,F,d,u),E(1)}},te+"")))),n):null};N(".j-byted-guide__custom-anchor{position:absolute;pointer-events:none;opacity:0}"),e.CUSTOM_ELEMENT_CLASS=s,e.default=function(e){var o=e.steps,n=e.localKey,i=e.mask,l=void 0===i||i,a=e.arrow,c=void 0===a||a,d=e.hotspot,g=void 0!==d&&d,b=e.closable,v=void 0===b||b,x=e.modalClassName,y=void 0===x?"":x,w=e.maskClassName,E=void 0===w?"":w,k=e.expireDate,T=void 0===k?"":k,C=e.step,N=void 0===C?0:C,P=e.beforeStepChange,M=e.afterStepChange,L=e.onClose,B=e.stepText,z=e.prevText,_=e.skipText,W=e.nextText,A=e.okText,F=e.lang,D=void 0===F?"zh":F,I=e.autoScroll,q=void 0===I||I,H=e.showPreviousBtn,K=void 0!==H&&H,U=e.showSkipBtn,X=void 0!==U&&U,V=e.closeEle,G=f(t.useState(-1),2),Y=G[0],$=G[1],J=f(t.useState(""),2),Q=J[0],Z=J[1],ee=f(t.useState(0),2),te=ee[0],oe=ee[1],ne=t.useMemo((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"zh";return function(t){var o;return null===(o=j[t])||void 0===o?void 0:o[e]}}(D)}),[D]),re=!Object.prototype.hasOwnProperty.call(e,"visible")||e.visible,ie=t.useMemo((function(){if(Y>=0&&o.length>Y){var e=o[Y],t=e.targetPos,n=e.selector;if(n)return function(e){var t=u(e);return"string"===t?document.querySelector(e):"function"===t?e():e}(n);if(t)return function(e){var t=document.querySelector(s);t&&document.body.removeChild(t);var o=document.createElement("div");return o.className=s,Object.entries(e).forEach((function(e){var t=f(e,2);o.style[t[0]]=t[1]+"px"})),document.body.appendChild(o),o}(t)}return null}),[Y,o[Y],te]),le=t.useMemo((function(){return ie?"body"===o[Y].parent||l?h(ie).body:S(ie):null}),[ie]),ae=t.useMemo((function(){return ie?p(ie):null}),[ie]),ue=t.useMemo((function(){return ie?m(ie):null}),[ie]),ce=function(){l&&(ue.style.overflow=Q);var e=document.querySelector(s);e&&document.body.removeChild(e),$(-1),null==L||L(),n&&localStorage.setItem(n,"true")},fe=function(e){"Escape"!==e.key||!v&&Y!==o.length-1||ce()};return t.useEffect((function(){if(re){var e=!!n&&localStorage.getItem(n),t=new Date(Date.parse(T.replace(/-/g,"/")));e||T&&new Date>t||$(N)}else $(-1)}),[re,N]),t.useEffect((function(){if(ae&&ue)return ae.addEventListener("keydown",fe),function(){ae.removeEventListener("keydown",fe)}}),[ae,ue]),t.useEffect((function(){0>Y||null==M||M(Y,o[Y])}),[Y]),t.useEffect((function(){l&&ue&&Z(ue.style.overflow||"scroll")}),[l,ue]),t.useEffect((function(){if(Y>=0){var e=new MutationObserver((function(){oe(te+1)}));return e.observe(document,{childList:!0,subtree:!0}),function(){e.disconnect()}}}),[Y,te]),l&&!Q||!le?null:r.default.createElement(r.default.Fragment,null,l&&r.default.createElement(O,{className:E,anchorEl:ie,realWindow:ae}),r.default.createElement(R,{anchorEl:ie,parentEl:le,realWindow:ae,steps:o,stepIndex:Y,mask:l,arrow:c,hotspot:g,closable:v,closeEle:V,onClose:ce,onChange:function(e){var t=Math.min(Math.max(Y+e,0),o.length);t!==Y&&(t===o.length?ce():0>Y||null==P||P(Y,o[Y]),$(t))},stepText:B,prevText:z,nextText:W,okText:A,skipText:_,className:y,TEXT:ne,autoScroll:q,showPreviousBtn:K,showSkipBtn:X}))},Object.defineProperty(e,"__esModule",{value:!0})}));
